<div class="container manage">
  <h2 class="title">
    @if(isAdd){
    {{ "createProduct" | translate }}
    }@else {
    {{ "updateProduct" | translate }}
    }
  </h2>
  <form (ngSubmit)="save(productForm)" #productForm="ngForm">
    <div class="row">
      <div class="form-group col-6">
        <label for="nameEn">{{ "nameEn" | translate }}</label>
        <input
          type="text"
          maxlength="100"
          minlength="3"
          class="form-control"
          id="nameEn"
          required
          #nameEn="ngModel"
          name="nameEn"
          [(ngModel)]="entity.name.english"
        />
        <app-form-error
          [control]="nameEn"
          fieldName="{{ 'nameEn' | translate }}"
        ></app-form-error>
      </div>

      <div class="form-group col-6">
        <label for="nameAr">{{ "nameAr" | translate }}</label>
        <input
          type="text"
          maxlength="100"
          class="form-control"
          id="nameAr"
          required
          name="nameAr"
          #nameAr="ngModel"
          [(ngModel)]="entity.name.arabic"
        />
        <app-form-error
          [control]="nameAr"
          fieldName="{{ 'nameAr' | translate }}"
        ></app-form-error>
      </div>
      <div class="form-group col-3">
        <label for="priceBeforeDiscount">{{
          "general.price-before-discount" | translate
        }}</label>
        <input
          type="number"
          class="form-control"
          id="priceBeforeDiscount"
          name="priceBeforeDiscount"
          [(ngModel)]="entity.priceBeforeDiscount"
          step="1"
          #priceBeforeDiscount="ngModel"
        />
        <app-form-error [control]="priceBeforeDiscount"></app-form-error>
      </div>
      <div class="form-group col-3">
        <label for="price">{{ "price" | translate }}</label>
        <input
          type="number"
          class="form-control"
          id="price"
          name="price"
          [(ngModel)]="entity.price"
          required
          step="1"
          required
          #price="ngModel"
        />
        <app-form-error [control]="price"></app-form-error>

        @if(entity&&entity.price&&entity.priceBeforeDiscount && entity.price >=
        entity.priceBeforeDiscount){
        <div class="error">
          {{ "validation.price-must-be-less-than-before-discount" | translate }}
        </div>
        }
      </div>

      <div class="form-group col-3">
        <label for="count">{{ "count" | translate }}</label>
        <input
          type="number"
          class="form-control"
          id="count"
          required
          name="count"
          [(ngModel)]="entity.count"
          required
          #count="ngModel"
        />
        <app-form-error [control]="count"></app-form-error>
      </div>
      <div class="form-group col-3">
        <!-- <mat-form-field appearance="fill" class="full-width"> -->
        <mat-label>
          {{ "keyAttribute.key-attribute-list" | translate }}</mat-label
        >
        <mat-select
          [(value)]="keyAttributeValueId"
          multiple
          class="form-control"
        >
          <mat-optgroup
            *ngFor="let category of keyAttributeList"
            [label]="category.name.local ?? ''"
          >
            <mat-option
              *ngFor="let sub of category.keyAttributeValues"
              [value]="sub.id"
            >
              {{ sub.value.local ?? "" }}
            </mat-option>
          </mat-optgroup>
        </mat-select>
        <!-- </mat-form-field> -->
      </div>

      <div class="form-group col-6">
        <label for="description">{{ "descriptionEn" | translate }}</label>
        <textarea
          class="form-control"
          id="descriptionEn"
          [rows]="3"
          name="descriptionEn"
          maxlength="500"
          [(ngModel)]="entity.description.english"
          #descriptionEn="ngModel"
        ></textarea>
        <app-form-error [control]="descriptionEn"></app-form-error>
      </div>
      <div class="form-group col-6">
        <label for="description">{{ "descriptionAr" | translate }}</label>
        <textarea
          class="form-control"
          id="descriptionAr"
          maxlength="500"
          name="descriptionAr"
          [rows]="3"
          [(ngModel)]="entity.description.arabic"
          #descriptionAr="ngModel"
        ></textarea>
        <app-form-error [control]="descriptionAr"></app-form-error>
      </div>
      <div class="form-group">
        <app-multi-image-upload
          [(images)]="entity.images"
        ></app-multi-image-upload>
      </div>
      <div class="btn-container">
        <button class="btn btn-secondary" (click)="goBack()">
          {{ "general.back" | translate }}
        </button>
        <button type="submit" class="btn btn-primary mx-2">
          {{ "general.save" | translate }}
        </button>
      </div>
    </div>
  </form>
</div>
